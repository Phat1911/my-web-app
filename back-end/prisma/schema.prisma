generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id String @id @default(uuid())
  name String
  email String @unique
  password String 
  previewURL String @default("")
  score Int @default(0)
  createAt DateTime @default(now())

  watchlistItems WatchListItem[]
  movies Movie[] @relation("MovieCreator")
  favMovies Movie[] @relation("Fan") 
}

model Movie {
  id String @id @default(uuid())
  title String
  overview String
  releaseYear Int
  genres String[] @default([])
  runtime Int?
  posterUrl String?
  createdBy String?
  likedBy String?
  createAt DateTime @default(now())

  creator User? @relation("MovieCreator", fields: [createdBy], references: [id], onDelete: Cascade)
  fan User? @relation("Fan", fields: [likedBy], references: [id], onDelete: Cascade)
  watchlistItems WatchListItem[]
}

model WatchListItem {
  id String @id @default(uuid())
  userId String
  movieId String
  status WatchListStatus @default(PLANNED)
  rating Int? 
  notes String?
  createAt DateTime @default(now())
  updateAt DateTime @default(now())

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade) 
  movie Movie @relation(fields: [movieId], references: [id], onDelete: Cascade)

  @@unique([userId, movieId]) 
}

enum WatchListStatus {
  PLANNED
  WATCHING
  COMPLETED
  DROPPED 
}